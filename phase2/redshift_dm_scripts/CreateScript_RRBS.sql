CREATE TABLE if NOT EXISTS log_batch_files_rrbs
(
    batch_id                integer GENERATED BY DEFAULT AS identity(1,1) encode raw distkey, --default default_identity(662527, 0, ('1,1'::character varying)::text) encode raw distkey,
    file_source             varchar(50) encode zstd,
    target_system           varchar(100) encode zstd,
    file_id                 integer encode az64,
    file_name               varchar(50) encode raw,
    batch_from              timestamp encode az64,
    batch_to                timestamp encode az64,
    record_count            integer encode az64,
    dm_normal_count         integer encode az64,
    dm_latecdr_count        integer encode az64,
    ldm_latecdr_count       integer encode az64,
    dm_normal_dbdupl_count  integer encode az64,
    dm_latecdr_dbdupl_count integer encode az64,
    is_valid                varchar(20),
    batch_createtime        timestamp encode az64
)
    diststyle key
    sortkey (batch_id, file_name);

CREATE TABLE if NOT EXISTS log_batch_status_rrbs
(
    batch_id                    integer encode raw distkey,
    s3_batchreadcount           integer encode az64,
    s3_filecount                integer encode az64,
    intrabatch_new_normal_count integer encode az64,
    intrabatch_new_late_count   integer encode az64,
    intrabatch_dupl_count       integer encode az64,
    intrabatch_dist_dupl_count  integer encode az64,
    intrabatch_dedupl_status    varchar(20),
    dm_normal_count             integer encode az64,
    dm_normal_dbdupl_count      integer encode az64,
    dm_normal_status            varchar(20),
    ldm_latecdr_count           integer encode az64,
    ldm_latecdr_dbdupl_count    integer encode az64,
    ldm_latecdr_status          varchar(20),
    batch_start_dt              timestamp encode az64,
    batch_end_dt                timestamp encode az64,
    batch_status                varchar(50)
)
    diststyle key
	sortkey (batch_id)
	;

create table fact_rrbs_balance_transfer
(
    sk_rrbs_bt                             bigint default default_identity(159726, 0, ('1,1'::character varying)::text) encode az64,
    cdr_type                               integer,
    network_id                             integer encode az64,
    service_id                             varchar(30) encode zstd,
    msisdn_no                              bigint encode az64,
    imsi                                   bigint encode az64 distkey,
    receiver_msisdn                        varchar(30) encode zstd,
    account_balance                        numeric(22, 6) encode az64,
    amount_transferred                     numeric(22, 6) encode az64,
    final_account_balance                  numeric(22, 6) encode az64,
    operation_code                         varchar(30) encode zstd,
    transaction_id                         varchar(50) encode zstd,
    bundle_code                            integer encode az64,
    threshold_amount                       varchar(50) encode zstd,
    bytes_charged                          varchar(50) encode zstd,
    cardid                                 varchar(50) encode zstd,
    friend_type                            varchar(50) encode zstd,
    reward_point_type                      varchar(50) encode zstd,
    reward_point                           varchar(50) encode zstd,
    over_write_bundle_code                 varchar(50) encode zstd,
    over_write_bucket_id                   varchar(50) encode zstd,
    over_write_bundle_subscriber_counter   varchar(50) encode zstd,
    subscriber_counter                     varchar(50) encode zstd,
    cdr_time_stamp                         timestamp encode az64,
    amount_ind                             varchar(30) encode zstd,
    reason                                 varchar(50) encode zstd,
    new_bparty_number                      varchar(50) encode zstd,
    existing_bparty_number                 varchar(50) encode zstd,
    dedicated_account_balance              numeric(22, 6) encode az64,
    amount_detected_from_dedicated_balance numeric(22, 6) encode az64,
    final_balance_in_dedicated_account     numeric(22, 6) encode az64,
    actual_credit_limit                    numeric(22, 6) encode az64,
    available_credit_limit                 numeric(22, 6) encode az64,
    amount_detected_from_credit            numeric(22, 6) encode az64,
    vat_amount                             numeric(22, 6) encode az64,
    da_track                               varchar(50) encode zstd,
    da_principal_amount                    varchar(50) encode zstd,
    pocket_id                              varchar(50) encode zstd,
    account_id                             varchar(50) encode zstd,
    channel_transaction_id                 varchar(50) encode zstd,
    reserved1                              varchar(50) encode zstd,
    reserved2                              varchar(50) encode zstd,
    reserved3                              varchar(50) encode zstd,
    reserved4                              varchar(50) encode zstd,
    reserved5                              varchar(50) encode zstd,
    reserved6                              varchar(50) encode zstd,
    cdr_dt                                 date encode az64,
    cdr_dt_month                           integer,
    cdr_dt_num                             integer,
    cdr_time_stamp_gmt                     timestamp encode az64,
    cdr_dt_month_gmt                       integer encode az64,
    cdr_dt_num_gmt                         integer encode az64,
    cdr_dt_hour_gmt                        integer encode az64,
    filename                               varchar(100) encode zstd,
    batch_id                               integer encode az64,
    created_date                           timestamp encode az64,
    rec_checksum                           varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, cdr_type);

create table fact_rrbs_balance_transfer_latecdr
(
    sk_rrbs_bt                             bigint default default_identity(166487, 0, ('1,1'::character varying)::text) encode az64,
    cdr_type                               integer,
    network_id                             integer encode az64,
    service_id                             varchar(30) encode zstd,
    msisdn_no                              bigint encode az64,
    imsi                                   bigint encode az64 distkey,
    receiver_msisdn                        varchar(30) encode zstd,
    account_balance                        numeric(22, 6) encode az64,
    amount_transferred                     numeric(22, 6) encode az64,
    final_account_balance                  numeric(22, 6) encode az64,
    operation_code                         varchar(30) encode zstd,
    transaction_id                         varchar(50) encode zstd,
    bundle_code                            integer encode az64,
    threshold_amount                       varchar(50) encode zstd,
    bytes_charged                          varchar(50) encode zstd,
    cardid                                 varchar(50) encode zstd,
    friend_type                            varchar(50) encode zstd,
    reward_point_type                      varchar(50) encode zstd,
    reward_point                           varchar(50) encode zstd,
    over_write_bundle_code                 varchar(50) encode zstd,
    over_write_bucket_id                   varchar(50) encode zstd,
    over_write_bundle_subscriber_counter   varchar(50) encode zstd,
    subscriber_counter                     varchar(50) encode zstd,
    cdr_time_stamp                         timestamp encode az64,
    amount_ind                             varchar(30) encode zstd,
    reason                                 varchar(50) encode zstd,
    new_bparty_number                      varchar(50) encode zstd,
    existing_bparty_number                 varchar(50) encode zstd,
    dedicated_account_balance              numeric(22, 6) encode az64,
    amount_detected_from_dedicated_balance numeric(22, 6) encode az64,
    final_balance_in_dedicated_account     numeric(22, 6) encode az64,
    actual_credit_limit                    numeric(22, 6) encode az64,
    available_credit_limit                 numeric(22, 6) encode az64,
    amount_detected_from_credit            numeric(22, 6) encode az64,
    vat_amount                             numeric(22, 6) encode az64,
    da_track                               varchar(50) encode zstd,
    da_principal_amount                    varchar(50) encode zstd,
    pocket_id                              varchar(50) encode zstd,
    account_id                             varchar(50) encode zstd,
    channel_transaction_id                 varchar(50) encode zstd,
    reserved1                              varchar(50) encode zstd,
    reserved2                              varchar(50) encode zstd,
    reserved3                              varchar(50) encode zstd,
    reserved4                              varchar(50) encode zstd,
    reserved5                              varchar(50) encode zstd,
    reserved6                              varchar(50) encode zstd,
    cdr_dt                                 date encode az64,
    cdr_dt_month                           integer,
    cdr_dt_num                             integer,
    cdr_time_stamp_gmt                     timestamp encode az64,
    cdr_dt_month_gmt                       integer encode az64,
    cdr_dt_num_gmt                         integer encode az64,
    cdr_dt_hour_gmt                        integer encode az64,
    filename                               varchar(100) encode zstd,
    batch_id                               integer encode az64,
    created_date                           timestamp encode az64,
    rec_checksum                           varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, cdr_type);

create table fact_rrbs_balance_transfer_duplcdr
(
    sk_rrbs_bt                             bigint default default_identity(166490, 0, ('1,1'::character varying)::text) encode az64,
    cdr_type                               integer,
    network_id                             integer encode az64,
    service_id                             varchar(30) encode zstd,
    msisdn_no                              bigint encode az64,
    imsi                                   bigint encode az64 distkey,
    receiver_msisdn                        varchar(30) encode zstd,
    account_balance                        numeric(22, 6) encode az64,
    amount_transferred                     numeric(22, 6) encode az64,
    final_account_balance                  numeric(22, 6) encode az64,
    operation_code                         varchar(30) encode zstd,
    transaction_id                         varchar(50) encode zstd,
    bundle_code                            integer encode az64,
    threshold_amount                       varchar(50) encode zstd,
    bytes_charged                          varchar(50) encode zstd,
    cardid                                 varchar(50) encode zstd,
    friend_type                            varchar(50) encode zstd,
    reward_point_type                      varchar(50) encode zstd,
    reward_point                           varchar(50) encode zstd,
    over_write_bundle_code                 varchar(50) encode zstd,
    over_write_bucket_id                   varchar(50) encode zstd,
    over_write_bundle_subscriber_counter   varchar(50) encode zstd,
    subscriber_counter                     varchar(50) encode zstd,
    cdr_time_stamp                         timestamp encode az64,
    amount_ind                             varchar(30) encode zstd,
    reason                                 varchar(50) encode zstd,
    new_bparty_number                      varchar(50) encode zstd,
    existing_bparty_number                 varchar(50) encode zstd,
    dedicated_account_balance              numeric(22, 6) encode az64,
    amount_detected_from_dedicated_balance numeric(22, 6) encode az64,
    final_balance_in_dedicated_account     numeric(22, 6) encode az64,
    actual_credit_limit                    numeric(22, 6) encode az64,
    available_credit_limit                 numeric(22, 6) encode az64,
    amount_detected_from_credit            numeric(22, 6) encode az64,
    vat_amount                             numeric(22, 6) encode az64,
    da_track                               varchar(50) encode zstd,
    da_principal_amount                    varchar(50) encode zstd,
    pocket_id                              varchar(50) encode zstd,
    account_id                             varchar(50) encode zstd,
    channel_transaction_id                 varchar(50) encode zstd,
    reserved1                              varchar(50) encode zstd,
    reserved2                              varchar(50) encode zstd,
    reserved3                              varchar(50) encode zstd,
    reserved4                              varchar(50) encode zstd,
    reserved5                              varchar(50) encode zstd,
    reserved6                              varchar(50) encode zstd,
    cdr_dt                                 date encode az64,
    cdr_dt_month                           integer,
    cdr_dt_num                             integer,
    cdr_time_stamp_gmt                     timestamp encode az64,
    cdr_dt_month_gmt                       integer encode az64,
    cdr_dt_num_gmt                         integer encode az64,
    cdr_dt_hour_gmt                        integer encode az64,
    filename                               varchar(100) encode zstd,
    batch_id                               integer encode az64,
    created_date                           timestamp encode az64,
    rec_checksum                           varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, cdr_type);

create table fact_rrbs_sms
(
    sk_rrbs_sms                     bigint GENERATED BY DEFAULT AS identity(1,1) encode az64, --default default_identity(1, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_types                       smallint encode raw,
    network_id                      smallint encode raw,
    call_type                       smallint encode raw,
    plan_id                         integer encode az64,
    service_id                      smallint encode az64,
    cli                             bigint encode az64,
    dialed_number                   varchar(50) encode zstd,
    imsi                            bigint encode az64 distkey,
    serving_node                    bigint encode az64,
    destination_area_code           integer encode az64,
    destination_zone_code           integer encode az64,
    destination_zone_name           varchar(50) encode zstd,
    roam_flag                       integer encode raw,
    roaming_node                    integer encode az64,
    roaming_area_code               integer encode az64,
    roaming_zone_name               varchar(50) encode zstd,
    sms_feature                     integer encode az64,
    number_of_sms_charged           integer encode az64,
    number_of_free_sms              integer encode az64,
    initial_account_balance         numeric(22, 6) encode az64,
    msg_cost                        numeric(22, 6) encode az64,
    balance                         numeric(22, 6) encode az64,
    free_sms_account_balance        integer encode az64,
    instance_id_session_id          varchar(20) encode zstd,
    account_id                      integer encode az64,
    dept_id                         integer encode az64,
    free_zone_id                    integer encode az64,
    last_topup_type                 smallint encode az64,
    bundle_code                     integer encode az64,
    free_zone_expiry_date           date encode zstd,
    bundle_sms_charge               numeric(22, 6) encode az64,
    bundle_balance                  numeric(22, 6) encode az64,
    bundle_plan_id                  integer encode az64,
    nsms_free_units                 integer encode az64,
    local_roam_country_code         smallint encode az64,
    msg_date                        timestamp encode zstd,
    bucket_type                     smallint encode az64,
    initial_free_units              numeric(22, 6) encode zstd,
    subscriber_type                 smallint encode az64,
    sub_acct_id                     bigint encode az64,
    family_id                       varchar(50) encode zstd,
    concat_message_flag             smallint encode az64,
    concat_message_reference_number integer encode az64,
    concat_message_total_chunks     integer encode az64,
    concat_message_current_chunk    integer encode az64,
    trace_id                        varchar(50) encode zstd,
    idp_time                        varchar(50) encode zstd,
    extension_record                smallint encode az64,
    call_indicator                  smallint encode az64,
    serving_node_name               varchar(50) encode zstd,
    bundle_version_name             varchar(50) encode zstd,
    flh_reward_slab_id              integer encode az64,
    bundle_version_id               smallint encode az64,
    rate_id                         integer encode az64,
    pricing_plan_id                 smallint encode az64,
    pocket_id                       bigint encode az64,
    consumed_promo_amount           numeric(22, 6) encode az64,
    rlh_charging_indicator          smallint encode az64,
    surcharge_consumed              varchar(50) encode zstd,
    roaming_partner_id              varchar(50) encode zstd,
    fct_free_text_1                 varchar(50) encode zstd,
    fct_free_text_2                 varchar(50) encode zstd,
    fct_free_text_3                 varchar(50) encode zstd,
    fct_free_text_4                 varchar(50) encode zstd,
    fct_free_text_5                 varchar(50) encode zstd,
    fct_free_text_6                 varchar(50) encode zstd,
    fct_free_text_7                 varchar(50) encode zstd,
    fct_free_text_8                 varchar(50) encode zstd,
    fct_free_text_9                 varchar(50) encode zstd,
    fct_free_text_10                varchar(50) encode zstd,
    msg_date_month                  integer encode raw,
    msg_date_dt                     date encode az64,
    msg_date_num                    integer encode raw,
    msg_date_hour                   integer encode az64,
    msg_date_month_gmt              integer encode az64,
    msg_date_num_gmt                integer encode az64,
    msg_date_hour_gmt               integer encode az64,
    msg_date_time_gmt               timestamp encode zstd,
    free_zone_expiry_date_num       integer encode az64,
    roaming_partner_name            varchar(50) encode zstd,
    filename                        varchar(100) not null encode zstd,
    batch_id                        integer      not null encode zstd,
    created_date                    timestamp    not null encode zstd,
    rec_checksum                    varchar(32) encode zstd
)
    diststyle key
    sortkey (msg_date_month, msg_date_num, network_id, cdr_types, roam_flag, call_type);

create table fact_rrbs_sms_latecdr
(
    sk_rrbs_sms                     bigint GENERATED BY DEFAULT AS identity(1,1) encode az64, --bigint default default_identity(167488, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_types                       smallint,
    network_id                      smallint,
    call_type                       smallint,
    plan_id                         integer encode az64,
    service_id                      smallint encode az64,
    cli                             bigint encode az64,
    dialed_number                   varchar(50) encode zstd,
    imsi                            bigint encode az64 distkey,
    serving_node                    bigint encode az64,
    destination_area_code           integer encode az64,
    destination_zone_code           integer encode az64,
    destination_zone_name           varchar(50) encode zstd,
    roam_flag                       integer,
    roaming_node                    integer encode az64,
    roaming_area_code               integer encode az64,
    roaming_zone_name               varchar(50) encode zstd,
    sms_feature                     integer encode az64,
    number_of_sms_charged           integer encode az64,
    number_of_free_sms              integer encode az64,
    initial_account_balance         numeric(22, 6) encode az64,
    msg_cost                        numeric(22, 6) encode az64,
    balance                         numeric(22, 6) encode az64,
    free_sms_account_balance        integer encode az64,
    instance_id_session_id          varchar(20) encode zstd,
    account_id                      integer encode az64,
    dept_id                         integer encode az64,
    free_zone_id                    integer encode az64,
    last_topup_type                 smallint encode az64,
    bundle_code                     integer encode az64,
    free_zone_expiry_date           date encode zstd,
    bundle_sms_charge               numeric(22, 6) encode az64,
    bundle_balance                  numeric(22, 6) encode az64,
    bundle_plan_id                  integer encode az64,
    nsms_free_units                 integer encode az64,
    local_roam_country_code         smallint encode az64,
    msg_date                        timestamp encode zstd,
    bucket_type                     smallint encode az64,
    initial_free_units              numeric(22, 6) encode zstd,
    subscriber_type                 smallint encode az64,
    sub_acct_id                     bigint encode az64,
    family_id                       varchar(50) encode zstd,
    concat_message_flag             smallint encode az64,
    concat_message_reference_number integer encode az64,
    concat_message_total_chunks     integer encode az64,
    concat_message_current_chunk    integer encode az64,
    trace_id                        varchar(50) encode zstd,
    idp_time                        varchar(50) encode zstd,
    extension_record                smallint encode az64,
    call_indicator                  smallint encode az64,
    serving_node_name               varchar(50) encode zstd,
    bundle_version_name             varchar(50) encode zstd,
    flh_reward_slab_id              integer encode az64,
    bundle_version_id               smallint encode az64,
    rate_id                         integer encode az64,
    pricing_plan_id                 smallint encode az64,
    pocket_id                       bigint encode az64,
    consumed_promo_amount           numeric(22, 6) encode az64,
    rlh_charging_indicator          smallint encode az64,
    surcharge_consumed              varchar(50) encode zstd,
    roaming_partner_id              varchar(50) encode zstd,
    fct_free_text_1                 varchar(50) encode zstd,
    fct_free_text_2                 varchar(50) encode zstd,
    fct_free_text_3                 varchar(50) encode zstd,
    fct_free_text_4                 varchar(50) encode zstd,
    fct_free_text_5                 varchar(50) encode zstd,
    fct_free_text_6                 varchar(50) encode zstd,
    fct_free_text_7                 varchar(50) encode zstd,
    fct_free_text_8                 varchar(50) encode zstd,
    fct_free_text_9                 varchar(50) encode zstd,
    fct_free_text_10                varchar(50) encode zstd,
    msg_date_month                  integer,
    msg_date_dt                     date encode az64,
    msg_date_num                    integer encode az64,
    msg_date_hour                   integer encode az64,
    msg_date_month_gmt              integer encode az64,
    msg_date_num_gmt                integer encode az64,
    msg_date_hour_gmt               integer encode az64,
    msg_date_time_gmt               timestamp encode zstd,
    free_zone_expiry_date_num       integer encode az64,
    roaming_partner_name            varchar(50) encode zstd,
    filename                        varchar(100) not null encode zstd,
    batch_id                        integer      not null encode zstd,
    created_date                    timestamp    not null encode zstd,
    rec_checksum                    varchar(32) encode zstd
)
    diststyle key
    sortkey (msg_date_month, msg_date_num, network_id, cdr_types, roam_flag, call_type);

create table fact_rrbs_sms_duplcdr
(
    sk_rrbs_sms                     bigint GENERATED BY DEFAULT AS identity(1,1) encode az64, --bigint default default_identity(167491, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_types                       smallint,
    network_id                      smallint,
    call_type                       smallint,
    plan_id                         integer encode az64,
    service_id                      smallint encode az64,
    cli                             bigint encode az64,
    dialed_number                   varchar(50) encode zstd,
    imsi                            bigint encode az64 distkey,
    serving_node                    bigint encode az64,
    destination_area_code           integer encode az64,
    destination_zone_code           integer encode az64,
    destination_zone_name           varchar(50) encode zstd,
    roam_flag                       integer,
    roaming_node                    integer encode az64,
    roaming_area_code               integer encode az64,
    roaming_zone_name               varchar(50) encode zstd,
    sms_feature                     integer encode az64,
    number_of_sms_charged           integer encode az64,
    number_of_free_sms              integer encode az64,
    initial_account_balance         numeric(22, 6) encode az64,
    msg_cost                        numeric(22, 6) encode az64,
    balance                         numeric(22, 6) encode az64,
    free_sms_account_balance        integer encode az64,
    instance_id_session_id          varchar(20) encode zstd,
    account_id                      integer encode az64,
    dept_id                         integer encode az64,
    free_zone_id                    integer encode az64,
    last_topup_type                 smallint encode az64,
    bundle_code                     integer encode az64,
    free_zone_expiry_date           date encode zstd,
    bundle_sms_charge               numeric(22, 6) encode az64,
    bundle_balance                  numeric(22, 6) encode az64,
    bundle_plan_id                  integer encode az64,
    nsms_free_units                 integer encode az64,
    local_roam_country_code         smallint encode az64,
    msg_date                        timestamp encode zstd,
    bucket_type                     smallint encode az64,
    initial_free_units              numeric(22, 6) encode zstd,
    subscriber_type                 smallint encode az64,
    sub_acct_id                     bigint encode az64,
    family_id                       varchar(50) encode zstd,
    concat_message_flag             smallint encode az64,
    concat_message_reference_number integer encode az64,
    concat_message_total_chunks     integer encode az64,
    concat_message_current_chunk    integer encode az64,
    trace_id                        varchar(50) encode zstd,
    idp_time                        varchar(50) encode zstd,
    extension_record                smallint encode az64,
    call_indicator                  smallint encode az64,
    serving_node_name               varchar(50) encode zstd,
    bundle_version_name             varchar(50) encode zstd,
    flh_reward_slab_id              integer encode az64,
    bundle_version_id               smallint encode az64,
    rate_id                         integer encode az64,
    pricing_plan_id                 smallint encode az64,
    pocket_id                       bigint encode az64,
    consumed_promo_amount           numeric(22, 6) encode az64,
    rlh_charging_indicator          smallint encode az64,
    surcharge_consumed              varchar(50) encode zstd,
    roaming_partner_id              varchar(50) encode zstd,
    fct_free_text_1                 varchar(50) encode zstd,
    fct_free_text_2                 varchar(50) encode zstd,
    fct_free_text_3                 varchar(50) encode zstd,
    fct_free_text_4                 varchar(50) encode zstd,
    fct_free_text_5                 varchar(50) encode zstd,
    fct_free_text_6                 varchar(50) encode zstd,
    fct_free_text_7                 varchar(50) encode zstd,
    fct_free_text_8                 varchar(50) encode zstd,
    fct_free_text_9                 varchar(50) encode zstd,
    fct_free_text_10                varchar(50) encode zstd,
    msg_date_month                  integer,
    msg_date_dt                     date encode az64,
    msg_date_num                    integer encode az64,
    msg_date_hour                   integer encode az64,
    msg_date_month_gmt              integer encode az64,
    msg_date_num_gmt                integer encode az64,
    msg_date_hour_gmt               integer encode az64,
    msg_date_time_gmt               timestamp encode zstd,
    free_zone_expiry_date_num       integer encode az64,
    roaming_partner_name            varchar(50) encode zstd,
    filename                        varchar(100) not null encode zstd,
    batch_id                        integer      not null encode zstd,
    created_date                    timestamp    not null encode zstd,
    rec_checksum                    varchar(32) encode zstd
)
    diststyle key
    sortkey (msg_date_month, msg_date_num, network_id, cdr_types, roam_flag, call_type);

create table fact_rrbs_gprs
(
    sk_rrbs_gprs                     bigint default default_identity(167584, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_type                         smallint encode az64,
    network_id                       smallint encode az64,
    data_feature                     smallint encode az64,
    tariffplan_id                    smallint encode az64,
    service_id                       smallint encode az64,
    msisdn                           bigint encode az64,
    apn                              varchar(100) encode zstd,
    pdp_address                      varchar(50) encode zstd,
    cellid                           varchar(50) encode zstd,
    imei                             varchar(50) encode zstd,
    imsi                             bigint encode az64 distkey,
    serving_node                     varchar(30) encode zstd,
    ggsn_address                     varchar(50) encode zstd,
    roaming_zone_name                varchar(30) encode zstd,
    roam_flag                        smallint encode az64,
    granted_bytes_cumulative         bigint encode az64,
    granted_money                    numeric(22, 6) encode az64,
    total_used_bytes                 bigint encode az64,
    chargeable_used_bytes            bigint encode az64,
    uploaded_bytes                   bigint encode az64,
    downloaded_bytes                 bigint encode az64,
    data_connection_time             timestamp encode zstd,
    data_termination_time            timestamp encode zstd,
    time_duration                    integer encode az64,
    initial_account_balance          numeric(22, 6) encode az64,
    data_charge                      numeric(22, 6) encode az64,
    final_account_balance            numeric(22, 6) encode az64,
    free_bytes                       bigint encode az64,
    sessionid                        varchar(50) encode zstd,
    last_topup_type                  smallint encode az64,
    free_data_expiry_date            date encode zstd,
    charge_indicator                 smallint encode az64,
    final_unit_indicator             smallint encode az64,
    bundle_code                      varchar(10),
    accid                            varchar(11) encode zstd,
    deptid                           varchar(15) encode zstd,
    bundle_used_data                 varchar(10) encode zstd,
    bundle_data_charge               numeric(22, 6) encode az64,
    bundle_balance                   numeric(22, 6) encode az64,
    bundle_plan_id                   varchar(5) encode zstd,
    local_roam_country_code          smallint encode az64,
    sdfid                            smallint encode az64,
    rategroupid                      smallint encode az64,
    serviceid                        varchar(4) encode zstd,
    cdr_time_stamp                   timestamp encode zstd,
    intial_free_units                bigint encode az64,
    subscriber_type                  smallint encode az64,
    cdr_sequence_number              integer encode az64,
    sub_acct_id                      bigint encode az64,
    ggsn_time                        varchar(100) encode zstd,
    tariff_plan_change_id            smallint encode az64,
    used_unit_bfr_tariff_plan_change bigint encode az64,
    family_account_id                integer encode az64,
    bundle_version_name              varchar(50) encode zstd,
    bundle_versionid                 smallint encode az64,
    reward_slab_id                   smallint encode az64,
    pricing_plan_id                  smallint encode az64,
    rate_id                          integer encode az64,
    pocket_id                        integer encode az64,
    consumed_promo_amount            numeric(22, 6) encode az64,
    consumed_surcharge               numeric(22, 6) encode az64,
    rlh_charging_indicator           smallint encode az64,
    granted_bytes_current            bigint encode az64,
    roaming_partner_id               smallint encode az64,
    fct_free_text_1                  varchar(50) encode zstd,
    fct_free_text_2                  varchar(50) encode zstd,
    fct_free_text_3                  varchar(50) encode zstd,
    fct_free_text_4                  varchar(50) encode zstd,
    fct_free_text_5                  varchar(50) encode zstd,
    fct_free_text_6                  varchar(50) encode zstd,
    fct_free_text_7                  varchar(50) encode zstd,
    fct_free_text_8                  varchar(50) encode zstd,
    fct_free_text_9                  varchar(50) encode zstd,
    fct_free_text_10                 varchar(50) encode zstd,
    data_connection_month            integer,
    data_connection_dt               date encode az64,
    data_connection_dt_num           integer encode az64,
    data_connection_hour             integer encode az64,
    data_termination_month           integer encode az64,
    data_termination_dt              date encode az64,
    data_termination_dt_num          integer encode az64,
    data_termination_hour            integer encode az64,
    data_connection_month_gmt        integer encode az64,
    data_connection_dt_num_gmt       integer encode az64,
    data_connection_hour_gmt         integer encode az64,
    data_connection_time_gmt         timestamp encode zstd,
    data_termination_month_gmt       integer encode az64,
    data_termination_dt_num_gmt      integer encode az64,
    data_termination_hour_gmt        integer encode az64,
    data_termination_time_gmt        timestamp encode zstd,
    total_usage_mb                   numeric(22, 6) encode az64,
    free_data_expiry_date_num        integer encode az64,
    roaming_partner_name             varchar(50) encode zstd,
    filename                         varchar(100) encode zstd,
    batch_id                         integer   not null encode zstd,
    created_date                     timestamp not null encode zstd,
    rec_checksum                     varchar(32) encode zstd
)
    diststyle key
    sortkey (data_connection_month, data_connection_dt_num, bundle_code);

create table fact_rrbs_gprs_duplcdr
(
    sk_rrbs_gprs                     bigint default default_identity(167587, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_type                         smallint encode az64,
    network_id                       smallint encode az64,
    data_feature                     smallint encode az64,
    tariffplan_id                    smallint encode az64,
    service_id                       smallint encode az64,
    msisdn                           bigint encode az64,
    apn                              varchar(100) encode zstd,
    pdp_address                      varchar(50) encode zstd,
    cellid                           varchar(50) encode zstd,
    imei                             varchar(50) encode zstd,
    imsi                             bigint encode az64 distkey,
    serving_node                     varchar(30) encode zstd,
    ggsn_address                     varchar(50) encode zstd,
    roaming_zone_name                varchar(30) encode zstd,
    roam_flag                        smallint encode az64,
    granted_bytes_cumulative         bigint encode az64,
    granted_money                    numeric(22, 6) encode az64,
    total_used_bytes                 bigint encode az64,
    chargeable_used_bytes            bigint encode az64,
    uploaded_bytes                   bigint encode az64,
    downloaded_bytes                 bigint encode az64,
    data_connection_time             timestamp encode zstd,
    data_termination_time            timestamp encode zstd,
    time_duration                    integer encode az64,
    initial_account_balance          numeric(22, 6) encode az64,
    data_charge                      numeric(22, 6) encode az64,
    final_account_balance            numeric(22, 6) encode az64,
    free_bytes                       bigint encode az64,
    sessionid                        varchar(50) encode zstd,
    last_topup_type                  smallint encode az64,
    free_data_expiry_date            date encode zstd,
    charge_indicator                 smallint encode az64,
    final_unit_indicator             smallint encode az64,
    bundle_code                      varchar(10),
    accid                            varchar(11) encode zstd,
    deptid                           varchar(15) encode zstd,
    bundle_used_data                 varchar(10) encode zstd,
    bundle_data_charge               numeric(22, 6) encode az64,
    bundle_balance                   numeric(22, 6) encode az64,
    bundle_plan_id                   varchar(5) encode zstd,
    local_roam_country_code          smallint encode az64,
    sdfid                            smallint encode az64,
    rategroupid                      smallint encode az64,
    serviceid                        varchar(4) encode zstd,
    cdr_time_stamp                   timestamp encode zstd,
    intial_free_units                bigint encode az64,
    subscriber_type                  smallint encode az64,
    cdr_sequence_number              integer encode az64,
    sub_acct_id                      bigint encode az64,
    ggsn_time                        varchar(100) encode zstd,
    tariff_plan_change_id            smallint encode az64,
    used_unit_bfr_tariff_plan_change bigint encode az64,
    family_account_id                integer encode az64,
    bundle_version_name              varchar(50) encode zstd,
    bundle_versionid                 smallint encode az64,
    reward_slab_id                   smallint encode az64,
    pricing_plan_id                  smallint encode az64,
    rate_id                          integer encode az64,
    pocket_id                        integer encode az64,
    consumed_promo_amount            numeric(22, 6) encode az64,
    consumed_surcharge               numeric(22, 6) encode az64,
    rlh_charging_indicator           smallint encode az64,
    granted_bytes_current            bigint encode az64,
    roaming_partner_id               smallint encode az64,
    fct_free_text_1                  varchar(50) encode zstd,
    fct_free_text_2                  varchar(50) encode zstd,
    fct_free_text_3                  varchar(50) encode zstd,
    fct_free_text_4                  varchar(50) encode zstd,
    fct_free_text_5                  varchar(50) encode zstd,
    fct_free_text_6                  varchar(50) encode zstd,
    fct_free_text_7                  varchar(50) encode zstd,
    fct_free_text_8                  varchar(50) encode zstd,
    fct_free_text_9                  varchar(50) encode zstd,
    fct_free_text_10                 varchar(50) encode zstd,
    data_connection_month            integer,
    data_connection_dt               date encode az64,
    data_connection_dt_num           integer encode az64,
    data_connection_hour             integer encode az64,
    data_termination_month           integer encode az64,
    data_termination_dt              date encode az64,
    data_termination_dt_num          integer encode az64,
    data_termination_hour            integer encode az64,
    data_connection_month_gmt        integer encode az64,
    data_connection_dt_num_gmt       integer encode az64,
    data_connection_hour_gmt         integer encode az64,
    data_connection_time_gmt         timestamp encode zstd,
    data_termination_month_gmt       integer encode az64,
    data_termination_dt_num_gmt      integer encode az64,
    data_termination_hour_gmt        integer encode az64,
    data_termination_time_gmt        timestamp encode zstd,
    total_usage_mb                   numeric(22, 6) encode az64,
    free_data_expiry_date_num        integer encode az64,
    roaming_partner_name             varchar(50) encode zstd,
    filename                         varchar(100) encode zstd,
    batch_id                         integer   not null encode zstd,
    created_date                     timestamp not null encode zstd,
    rec_checksum                     varchar(32) encode zstd
)
    diststyle key
    sortkey (data_connection_month, data_connection_dt_num, bundle_code);

create table fact_rrbs_gprs_latecdr
(
    sk_rrbs_gprs                     bigint default default_identity(167590, 0, ('1,1'::character varying)::text) encode zstd,
    cdr_type                         smallint encode az64,
    network_id                       smallint encode az64,
    data_feature                     smallint encode az64,
    tariffplan_id                    smallint encode az64,
    service_id                       smallint encode az64,
    msisdn                           bigint encode az64,
    apn                              varchar(100) encode zstd,
    pdp_address                      varchar(50) encode zstd,
    cellid                           varchar(50) encode zstd,
    imei                             varchar(50) encode zstd,
    imsi                             bigint encode az64 distkey,
    serving_node                     varchar(30) encode zstd,
    ggsn_address                     varchar(50) encode zstd,
    roaming_zone_name                varchar(30) encode zstd,
    roam_flag                        smallint encode az64,
    granted_bytes_cumulative         bigint encode az64,
    granted_money                    numeric(22, 6) encode az64,
    total_used_bytes                 bigint encode az64,
    chargeable_used_bytes            bigint encode az64,
    uploaded_bytes                   bigint encode az64,
    downloaded_bytes                 bigint encode az64,
    data_connection_time             timestamp encode zstd,
    data_termination_time            timestamp encode zstd,
    time_duration                    integer encode az64,
    initial_account_balance          numeric(22, 6) encode az64,
    data_charge                      numeric(22, 6) encode az64,
    final_account_balance            numeric(22, 6) encode az64,
    free_bytes                       bigint encode az64,
    sessionid                        varchar(50) encode zstd,
    last_topup_type                  smallint encode az64,
    free_data_expiry_date            date encode zstd,
    charge_indicator                 smallint encode az64,
    final_unit_indicator             smallint encode az64,
    bundle_code                      varchar(10),
    accid                            varchar(11) encode zstd,
    deptid                           varchar(15) encode zstd,
    bundle_used_data                 varchar(10) encode zstd,
    bundle_data_charge               numeric(22, 6) encode az64,
    bundle_balance                   numeric(22, 6) encode az64,
    bundle_plan_id                   varchar(5) encode zstd,
    local_roam_country_code          smallint encode az64,
    sdfid                            smallint encode az64,
    rategroupid                      smallint encode az64,
    serviceid                        varchar(4) encode zstd,
    cdr_time_stamp                   timestamp encode zstd,
    intial_free_units                bigint encode az64,
    subscriber_type                  smallint encode az64,
    cdr_sequence_number              integer encode az64,
    sub_acct_id                      bigint encode az64,
    ggsn_time                        varchar(100) encode zstd,
    tariff_plan_change_id            smallint encode az64,
    used_unit_bfr_tariff_plan_change bigint encode az64,
    family_account_id                integer encode az64,
    bundle_version_name              varchar(50) encode zstd,
    bundle_versionid                 smallint encode az64,
    reward_slab_id                   smallint encode az64,
    pricing_plan_id                  smallint encode az64,
    rate_id                          integer encode az64,
    pocket_id                        integer encode az64,
    consumed_promo_amount            numeric(22, 6) encode az64,
    consumed_surcharge               numeric(22, 6) encode az64,
    rlh_charging_indicator           smallint encode az64,
    granted_bytes_current            bigint encode az64,
    roaming_partner_id               smallint encode az64,
    fct_free_text_1                  varchar(50) encode zstd,
    fct_free_text_2                  varchar(50) encode zstd,
    fct_free_text_3                  varchar(50) encode zstd,
    fct_free_text_4                  varchar(50) encode zstd,
    fct_free_text_5                  varchar(50) encode zstd,
    fct_free_text_6                  varchar(50) encode zstd,
    fct_free_text_7                  varchar(50) encode zstd,
    fct_free_text_8                  varchar(50) encode zstd,
    fct_free_text_9                  varchar(50) encode zstd,
    fct_free_text_10                 varchar(50) encode zstd,
    data_connection_month            integer,
    data_connection_dt               date encode az64,
    data_connection_dt_num           integer encode az64,
    data_connection_hour             integer encode az64,
    data_termination_month           integer encode az64,
    data_termination_dt              date encode az64,
    data_termination_dt_num          integer encode az64,
    data_termination_hour            integer encode az64,
    data_connection_month_gmt        integer encode az64,
    data_connection_dt_num_gmt       integer encode az64,
    data_connection_hour_gmt         integer encode az64,
    data_connection_time_gmt         timestamp encode zstd,
    data_termination_month_gmt       integer encode az64,
    data_termination_dt_num_gmt      integer encode az64,
    data_termination_hour_gmt        integer encode az64,
    data_termination_time_gmt        timestamp encode zstd,
    total_usage_mb                   numeric(22, 6) encode az64,
    free_data_expiry_date_num        integer encode az64,
    roaming_partner_name             varchar(50) encode zstd,
    filename                         varchar(100) encode zstd,
    batch_id                         integer   not null encode zstd,
    created_date                     timestamp not null encode zstd,
    rec_checksum                     varchar(32) encode zstd
)
    diststyle key
    sortkey (data_connection_month, data_connection_dt_num, bundle_code);

create table fact_rrbs_voice
(
    sk_rrbs_voice                bigint default default_identity(167593, 0, ('1,1'::character varying)::text) encode zstd,
    voice_call_cdr               integer encode az64,
    network_id                   integer,
    call_type                    integer,
    call_feature                 integer encode az64,
    tariffplan_id                integer encode az64,
    service_id                   integer encode az64,
    cli                          bigint encode az64,
    dialed_number                varchar(50) encode zstd,
    charged_party_number         bigint encode az64,
    imsi                         bigint encode az64 distkey,
    serving_node                 bigint encode az64,
    mcc                          integer encode az64,
    mnc                          integer encode az64,
    lac                          integer encode az64,
    calling_cell_id              integer encode az64,
    cellzone_code                varchar(30) encode zstd,
    cellzone_name                varchar(30) encode zstd,
    original_dialed_number       bigint encode az64,
    destination_zone             integer encode az64,
    destination_area_code        bigint encode az64,
    destinationzone_name         varchar(30) encode bytedict,
    roaming_area_code            varchar(20) encode zstd,
    roaming_zone_name            varchar(30) encode zstd,
    roam_flag                    smallint,
    roam_area_number             integer encode az64,
    granted_time                 integer encode az64,
    granted_money                numeric(22, 6) encode zstd,
    call_duration                integer encode az64,
    chargeable_used_time         integer encode az64,
    call_date                    timestamp encode zstd,
    call_termination_time        timestamp encode zstd,
    initial_account_balance      numeric(22, 6) encode zstd,
    talk_charge                  numeric(22, 6) encode zstd,
    balance                      numeric(22, 6) encode zstd,
    free_minutes_account_balance numeric(22, 6) encode zstd,
    account_id                   integer encode az64,
    dept_id                      integer encode az64,
    free_zone_id                 integer encode az64,
    trace_id                     varchar(50) encode zstd,
    last_topup_type              smallint encode az64,
    bundle_code                  varchar(10) encode zstd,
    free_zone_expiry_date        varchar(50) encode zstd,
    ringing_duration             varchar(3) encode zstd,
    ring_indicator               varchar(1) encode zstd,
    national_bundle_code         varchar(10) encode zstd,
    national_used_minutes        varchar(10) encode zstd,
    national_charge              varchar(10) encode zstd,
    pool_number                  varchar(20) encode zstd,
    bundle_used_seconds          varchar(10) encode zstd,
    bundle_call_charge           varchar(10) encode zstd,
    bundle_balance               varchar(10) encode zstd,
    bundle_plan_id               varchar(5) encode zstd,
    final_unit_indicator         varchar(1) encode zstd,
    ncall_free_units             varchar(10) encode zstd,
    local_roam_country_code      varchar(4) encode zstd,
    cdr_time_stamp               timestamp encode zstd,
    bucket_type                  integer encode az64,
    conversion_unit              varchar(50) encode zstd,
    intial_free_units            integer encode az64,
    subscriber_type              integer encode az64,
    call_forwarding_indicator    integer encode az64,
    cdr_sequence_number          integer encode az64,
    sub_acct_id                  integer encode az64,
    announcement_time            integer encode az64,
    family_id                    integer encode az64,
    idp_time                     varchar(100) encode zstd,
    cs_free_mins                 varchar(50) encode zstd,
    free_units_detected          integer encode az64,
    multileg_charging_flag       integer encode az64,
    extension_record             integer encode az64,
    connect_number               varchar(50) encode zstd,
    dialed_number1               varchar(50) encode zstd,
    service_description          varchar(100) encode zstd,
    alternate_plan_id            varchar(50) encode zstd,
    serving_node_name            varchar(50) encode zstd,
    fixed_charge                 integer encode az64,
    fixed_charge_resource_impact varchar(50) encode zstd,
    bundle_version_name          varchar(50) encode zstd,
    flh_reward_slab_id           integer encode az64,
    bundle_version_id            integer encode az64,
    rate_id                      varchar(50) encode zstd,
    pricing_plan_id              varchar(50) encode zstd,
    pocket_id                    varchar(50) encode zstd,
    consumed_promo_amount        varchar(50) encode zstd,
    pervious_call_trace_id       varchar(50) encode zstd,
    termination_cause            integer encode az64,
    non_chargeable_unit          integer encode az64,
    call_forward_msisdn          varchar(50) encode zstd,
    service_type                 varchar(50) encode zstd,
    used_time_in_previous_grant  integer encode az64,
    rlh_charging_indicator       integer encode az64,
    surcharge_consumed           integer encode az64,
    excess_used_units_received   integer encode az64,
    failcause                    integer encode az64,
    roaming_partner_id           integer encode az64,
    fct_free_text_1              varchar(50) encode zstd,
    fct_free_text_2              varchar(50) encode zstd,
    fct_free_text_3              varchar(50) encode zstd,
    fct_free_text_4              varchar(50) encode zstd,
    fct_free_text_5              varchar(50) encode zstd,
    fct_free_text_6              varchar(50) encode zstd,
    fct_free_text_7              varchar(50) encode zstd,
    fct_free_text_8              varchar(50) encode zstd,
    fct_free_text_9              varchar(50) encode zstd,
    fct_free_text_10             varchar(50) encode zstd,
    call_date_month              integer,
    call_date_dt                 date encode az64,
    call_date_num                integer encode az64,
    call_date_hour               integer encode az64,
    call_date_month_gmt          integer encode az64,
    call_date_time_gmt           timestamp encode zstd,
    call_date_num_gmt            integer encode az64,
    call_date_hour_gmt           integer encode az64,
    call_duration_min            integer encode az64,
    chargeable_used_time_min     integer encode az64,
    roaming_partner_name         varchar(50) encode zstd,
    filename                     varchar(100) not null encode zstd,
    batch_id                     integer      not null encode zstd,
    created_date                 timestamp    not null encode zstd,
    rec_checksum                 varchar(32) encode zstd
)
    diststyle key
    sortkey (call_date_month, call_date_num, network_id, roam_flag, call_type);

create table fact_rrbs_voice_duplcdr
(
    sk_rrbs_voice                bigint default default_identity(167596, 0, ('1,1'::character varying)::text) encode zstd,
    voice_call_cdr               integer encode az64,
    network_id                   integer,
    call_type                    integer,
    call_feature                 integer encode az64,
    tariffplan_id                integer encode az64,
    service_id                   integer encode az64,
    cli                          bigint encode az64,
    dialed_number                varchar(50) encode zstd,
    charged_party_number         bigint encode az64,
    imsi                         bigint encode az64 distkey,
    serving_node                 bigint encode az64,
    mcc                          integer encode az64,
    mnc                          integer encode az64,
    lac                          integer encode az64,
    calling_cell_id              integer encode az64,
    cellzone_code                varchar(30) encode zstd,
    cellzone_name                varchar(30) encode zstd,
    original_dialed_number       bigint encode az64,
    destination_zone             integer encode az64,
    destination_area_code        bigint encode az64,
    destinationzone_name         varchar(30) encode bytedict,
    roaming_area_code            varchar(20) encode zstd,
    roaming_zone_name            varchar(30) encode zstd,
    roam_flag                    smallint,
    roam_area_number             integer encode az64,
    granted_time                 integer encode az64,
    granted_money                numeric(22, 6) encode zstd,
    call_duration                integer encode az64,
    chargeable_used_time         integer encode az64,
    call_date                    timestamp encode zstd,
    call_termination_time        timestamp encode zstd,
    initial_account_balance      numeric(22, 6) encode zstd,
    talk_charge                  numeric(22, 6) encode zstd,
    balance                      numeric(22, 6) encode zstd,
    free_minutes_account_balance numeric(22, 6) encode zstd,
    account_id                   integer encode az64,
    dept_id                      integer encode az64,
    free_zone_id                 integer encode az64,
    trace_id                     varchar(50) encode zstd,
    last_topup_type              smallint encode az64,
    bundle_code                  varchar(10) encode zstd,
    free_zone_expiry_date        varchar(50) encode zstd,
    ringing_duration             varchar(3) encode zstd,
    ring_indicator               varchar(1) encode zstd,
    national_bundle_code         varchar(10) encode zstd,
    national_used_minutes        varchar(10) encode zstd,
    national_charge              varchar(10) encode zstd,
    pool_number                  varchar(20) encode zstd,
    bundle_used_seconds          varchar(10) encode zstd,
    bundle_call_charge           varchar(10) encode zstd,
    bundle_balance               varchar(10) encode zstd,
    bundle_plan_id               varchar(5) encode zstd,
    final_unit_indicator         varchar(1) encode zstd,
    ncall_free_units             varchar(10) encode zstd,
    local_roam_country_code      varchar(4) encode zstd,
    cdr_time_stamp               timestamp encode zstd,
    bucket_type                  integer encode az64,
    conversion_unit              varchar(50) encode zstd,
    intial_free_units            integer encode az64,
    subscriber_type              integer encode az64,
    call_forwarding_indicator    integer encode az64,
    cdr_sequence_number          integer encode az64,
    sub_acct_id                  integer encode az64,
    announcement_time            integer encode az64,
    family_id                    integer encode az64,
    idp_time                     varchar(100) encode zstd,
    cs_free_mins                 varchar(50) encode zstd,
    free_units_detected          integer encode az64,
    multileg_charging_flag       integer encode az64,
    extension_record             integer encode az64,
    connect_number               varchar(50) encode zstd,
    dialed_number1               varchar(50) encode zstd,
    service_description          varchar(100) encode zstd,
    alternate_plan_id            varchar(50) encode zstd,
    serving_node_name            varchar(50) encode zstd,
    fixed_charge                 integer encode az64,
    fixed_charge_resource_impact varchar(50) encode zstd,
    bundle_version_name          varchar(50) encode zstd,
    flh_reward_slab_id           integer encode az64,
    bundle_version_id            integer encode az64,
    rate_id                      varchar(50) encode zstd,
    pricing_plan_id              varchar(50) encode zstd,
    pocket_id                    varchar(50) encode zstd,
    consumed_promo_amount        varchar(50) encode zstd,
    pervious_call_trace_id       varchar(50) encode zstd,
    termination_cause            integer encode az64,
    non_chargeable_unit          integer encode az64,
    call_forward_msisdn          varchar(50) encode zstd,
    service_type                 varchar(50) encode zstd,
    used_time_in_previous_grant  integer encode az64,
    rlh_charging_indicator       integer encode az64,
    surcharge_consumed           integer encode az64,
    excess_used_units_received   integer encode az64,
    failcause                    integer encode az64,
    roaming_partner_id           integer encode az64,
    fct_free_text_1              varchar(50) encode zstd,
    fct_free_text_2              varchar(50) encode zstd,
    fct_free_text_3              varchar(50) encode zstd,
    fct_free_text_4              varchar(50) encode zstd,
    fct_free_text_5              varchar(50) encode zstd,
    fct_free_text_6              varchar(50) encode zstd,
    fct_free_text_7              varchar(50) encode zstd,
    fct_free_text_8              varchar(50) encode zstd,
    fct_free_text_9              varchar(50) encode zstd,
    fct_free_text_10             varchar(50) encode zstd,
    call_date_month              integer,
    call_date_dt                 date encode az64,
    call_date_num                integer encode az64,
    call_date_hour               integer encode az64,
    call_date_month_gmt          integer encode az64,
    call_date_time_gmt           timestamp encode zstd,
    call_date_num_gmt            integer encode az64,
    call_date_hour_gmt           integer encode az64,
    call_duration_min            integer encode az64,
    chargeable_used_time_min     integer encode az64,
    roaming_partner_name         varchar(50) encode zstd,
    filename                     varchar(100) not null encode zstd,
    batch_id                     integer      not null encode zstd,
    created_date                 timestamp    not null encode zstd,
    rec_checksum                 varchar(32) encode zstd
)
    diststyle key
    sortkey (call_date_month, call_date_num, network_id, roam_flag, call_type);

create table fact_rrbs_voice_latecdr
(
    sk_rrbs_voice                bigint default default_identity(167599, 0, ('1,1'::character varying)::text) encode zstd,
    voice_call_cdr               integer encode az64,
    network_id                   integer,
    call_type                    integer,
    call_feature                 integer encode az64,
    tariffplan_id                integer encode az64,
    service_id                   integer encode az64,
    cli                          bigint encode az64,
    dialed_number                varchar(50) encode zstd,
    charged_party_number         bigint encode az64,
    imsi                         bigint encode az64 distkey,
    serving_node                 bigint encode az64,
    mcc                          integer encode az64,
    mnc                          integer encode az64,
    lac                          integer encode az64,
    calling_cell_id              integer encode az64,
    cellzone_code                varchar(30) encode zstd,
    cellzone_name                varchar(30) encode zstd,
    original_dialed_number       bigint encode az64,
    destination_zone             integer encode az64,
    destination_area_code        bigint encode az64,
    destinationzone_name         varchar(30) encode bytedict,
    roaming_area_code            varchar(20) encode zstd,
    roaming_zone_name            varchar(30) encode zstd,
    roam_flag                    smallint,
    roam_area_number             integer encode az64,
    granted_time                 integer encode az64,
    granted_money                numeric(22, 6) encode zstd,
    call_duration                integer encode az64,
    chargeable_used_time         integer encode az64,
    call_date                    timestamp encode zstd,
    call_termination_time        timestamp encode zstd,
    initial_account_balance      numeric(22, 6) encode zstd,
    talk_charge                  numeric(22, 6) encode zstd,
    balance                      numeric(22, 6) encode zstd,
    free_minutes_account_balance numeric(22, 6) encode zstd,
    account_id                   integer encode az64,
    dept_id                      integer encode az64,
    free_zone_id                 integer encode az64,
    trace_id                     varchar(50) encode zstd,
    last_topup_type              smallint encode az64,
    bundle_code                  varchar(10) encode zstd,
    free_zone_expiry_date        varchar(50) encode zstd,
    ringing_duration             varchar(3) encode zstd,
    ring_indicator               varchar(1) encode zstd,
    national_bundle_code         varchar(10) encode zstd,
    national_used_minutes        varchar(10) encode zstd,
    national_charge              varchar(10) encode zstd,
    pool_number                  varchar(20) encode zstd,
    bundle_used_seconds          varchar(10) encode zstd,
    bundle_call_charge           varchar(10) encode zstd,
    bundle_balance               varchar(10) encode zstd,
    bundle_plan_id               varchar(5) encode zstd,
    final_unit_indicator         varchar(1) encode zstd,
    ncall_free_units             varchar(10) encode zstd,
    local_roam_country_code      varchar(4) encode zstd,
    cdr_time_stamp               timestamp encode zstd,
    bucket_type                  integer encode az64,
    conversion_unit              varchar(50) encode zstd,
    intial_free_units            integer encode az64,
    subscriber_type              integer encode az64,
    call_forwarding_indicator    integer encode az64,
    cdr_sequence_number          integer encode az64,
    sub_acct_id                  integer encode az64,
    announcement_time            integer encode az64,
    family_id                    integer encode az64,
    idp_time                     varchar(100) encode zstd,
    cs_free_mins                 varchar(50) encode zstd,
    free_units_detected          integer encode az64,
    multileg_charging_flag       integer encode az64,
    extension_record             integer encode az64,
    connect_number               varchar(50) encode zstd,
    dialed_number1               varchar(50) encode zstd,
    service_description          varchar(100) encode zstd,
    alternate_plan_id            varchar(50) encode zstd,
    serving_node_name            varchar(50) encode zstd,
    fixed_charge                 integer encode az64,
    fixed_charge_resource_impact varchar(50) encode zstd,
    bundle_version_name          varchar(50) encode zstd,
    flh_reward_slab_id           integer encode az64,
    bundle_version_id            integer encode az64,
    rate_id                      varchar(50) encode zstd,
    pricing_plan_id              varchar(50) encode zstd,
    pocket_id                    varchar(50) encode zstd,
    consumed_promo_amount        varchar(50) encode zstd,
    pervious_call_trace_id       varchar(50) encode zstd,
    termination_cause            integer encode az64,
    non_chargeable_unit          integer encode az64,
    call_forward_msisdn          varchar(50) encode zstd,
    service_type                 varchar(50) encode zstd,
    used_time_in_previous_grant  integer encode az64,
    rlh_charging_indicator       integer encode az64,
    surcharge_consumed           integer encode az64,
    excess_used_units_received   integer encode az64,
    failcause                    integer encode az64,
    roaming_partner_id           integer encode az64,
    fct_free_text_1              varchar(50) encode zstd,
    fct_free_text_2              varchar(50) encode zstd,
    fct_free_text_3              varchar(50) encode zstd,
    fct_free_text_4              varchar(50) encode zstd,
    fct_free_text_5              varchar(50) encode zstd,
    fct_free_text_6              varchar(50) encode zstd,
    fct_free_text_7              varchar(50) encode zstd,
    fct_free_text_8              varchar(50) encode zstd,
    fct_free_text_9              varchar(50) encode zstd,
    fct_free_text_10             varchar(50) encode zstd,
    call_date_month              integer,
    call_date_dt                 date encode az64,
    call_date_num                integer encode az64,
    call_date_hour               integer encode az64,
    call_date_month_gmt          integer encode az64,
    call_date_time_gmt           timestamp encode zstd,
    call_date_num_gmt            integer encode az64,
    call_date_hour_gmt           integer encode az64,
    call_duration_min            integer encode az64,
    chargeable_used_time_min     integer encode az64,
    roaming_partner_name         varchar(50) encode zstd,
    filename                     varchar(100) not null encode zstd,
    batch_id                     integer      not null encode zstd,
    created_date                 timestamp    not null encode zstd,
    rec_checksum                 varchar(32) encode zstd
)
    diststyle key
    sortkey (call_date_month, call_date_num, network_id, roam_flag, call_type);

create table fact_rrbs_topup
(
    sk_rrbs_topup                            bigint default default_identity(167657, 0, ('1,1'::character varying)::text) encode zstd,
    operation_code                           smallint,
    network_id                               smallint,
    recharge_type                            smallint encode az64,
    msisdn                                   bigint encode az64,
    imsi                                     bigint encode az64 distkey,
    account_pin_number                       varchar(50) encode zstd,
    voucher_card_id                          integer encode az64,
    special_topup_amount                     numeric(22, 6) encode az64,
    transaction_id                           varchar(50) encode zstd,
    new_balance                              numeric(22, 6) encode az64,
    face_value                               numeric(22, 6) encode az64,
    recharge_amount                          numeric(22, 6) encode az64,
    promo_validity_date                      date encode az64,
    free_minutes                             integer encode az64,
    free_voucher_onnet_minutes               integer encode az64,
    free_minutes_expiry_date                 date encode az64,
    free_sms                                 integer encode az64,
    free_voucher_onnet_sms                   integer encode az64,
    free_sms_expiry_date                     date encode az64,
    free_offnet_minutes                      integer encode az64,
    free_voucher_offnet_minutes              integer encode az64,
    free_offnet_minutes_expiry_date          date encode az64,
    free_offnet_sms                          integer encode az64,
    free_voucher_offnet_sms                  integer encode az64,
    free_offnet_sms_expiry_date              date encode az64,
    free_offnet2_minutes                     integer encode az64,
    free_vouchercard_offnet2_minutes         integer encode az64,
    free_offnet2_minutes_expiry_date         date encode az64,
    free_offnet2_sms                         integer encode az64,
    free_vouchercard_offnet2_sms             integer encode az64,
    free_offnet2_sms_expiry_date             date encode az64,
    free_offnet3_minutes                     integer encode az64,
    free_vouchercard_offnet3_minutes         integer encode az64,
    free_offnet3_minutes_expiry_date         date encode az64,
    free_offnet3_sms                         integer encode az64,
    free_vouchercard_offnet3_sms             integer encode az64,
    free_offnet3_sms_expiry_date             date encode az64,
    free_data                                bigint encode az64,
    free_voucher_data                        bigint encode az64,
    free_data_expirydate                     date encode az64,
    account_validity_date                    date encode az64,
    lyca_voucher_card_id                     varchar(50) encode zstd,
    planid                                   smallint encode az64,
    topup_counter                            smallint encode az64,
    bundle_code                              integer encode az64,
    imei                                     varchar(25) encode zstd,
    voucher_onnet_mins_expdt                 date encode az64,
    voucher_onnet_sms_expdt                  date encode az64,
    voucher_offnet_mins_expdt1               date encode az64,
    voucher_offnet_sms_expdt1                date encode az64,
    voucher_offnet_mins_expdt2               date encode az64,
    voucher_offnet_sms_expdt2                date encode az64,
    voucher_offnet_mins_expdt3               date encode az64,
    voucher_offnet_sms_expdt3                date encode az64,
    voucher_free_dataexp                     date encode az64,
    retailer_msisdn                          varchar(21) encode zstd,
    staff_msisdn                             varchar(21) encode zstd,
    wlm_topupmode                            varchar(50) encode zstd,
    face_value_1                             numeric(22, 6) encode az64,
    promo_validity_days                      integer encode az64,
    oldplanid                                integer encode az64,
    onnet_mt_mins                            integer encode az64,
    voucher_onnet_mt_mins                    integer encode az64,
    onnet_mt_sms                             integer encode az64,
    voucher_onnet_mt_sms                     integer encode az64,
    onnet_mt_exp_dt                          date encode az64,
    voucher_onnet_mt_expiry_date             date encode az64,
    offnet_mt_mins                           integer encode az64,
    voucher_offnet_mt_mins                   integer encode az64,
    offnet_mt_sms                            integer encode az64,
    voucher_offnet_mt_sms                    integer encode az64,
    offnet_mt_exp_dt                         date encode az64,
    voucher_offnet_mt_expiry_date            date encode az64,
    bundle_name                              varchar(100) encode zstd,
    old_account_balance                      numeric(22, 6) encode az64,
    parent_msisdn                            varchar(25) encode zstd,
    rrbs_transaction_id                      varchar(50) encode zstd,
    override_bundle                          integer encode az64,
    vouchernetworkid                         smallint encode az64,
    accid                                    varchar(10) encode zstd,
    deptid                                   varchar(10) encode zstd,
    bundle_catery                            smallint encode az64,
    plan_validity_days                       smallint encode az64,
    account_id                               bigint encode az64,
    sim_number                               bigint encode az64,
    cdr_time_stamp                           timestamp encode zstd,
    reservation                              smallint encode az64,
    discount_promo_code                      varchar(50) encode zstd,
    discount_promo_amount                    numeric(22, 6) encode az64,
    primary_bundle_code                      integer encode az64,
    family_account_id                        varchar(50) encode zstd,
    tax                                      numeric(22, 6) encode az64,
    number_of_installments                   integer encode az64,
    oba_bundle_flag                          smallint encode az64,
    oba_due_amount                           numeric(22, 6) encode az64,
    parent_bundle_code                       integer encode az64,
    bundle_unit_type                         smallint encode az64,
    contract_start_date                      date encode az64,
    contract_end_date                        varchar(50) encode zstd,
    flh_flag                                 smallint encode az64,
    exibs_retailer_transaction_id            varchar(50) encode zstd,
    operation_flag                           smallint encode az64,
    vat_amount                               numeric(22, 6) encode az64,
    special_discount_code                    varchar(50) encode zstd,
    special_discount_amount                  numeric(22, 6) encode az64,
    number_of_installments_discounts_applied varchar(50) encode zstd,
    actual_bundle_cost                       numeric(22, 6) encode az64,
    reservation_reference_transaction_id     varchar(50) encode zstd,
    bundle_expiry_type                       smallint encode az64,
    bundle_balance                           numeric(22, 6) encode az64,
    muv_indicator                            smallint encode az64,
    bundle_group_type                        smallint encode az64,
    sequence_number                          smallint encode az64,
    amount_refunded                          numeric(22, 6) encode az64,
    forcible_cancellation                    varchar(50) encode zstd,
    payment_mode_indicator                   varchar(50) encode zstd,
    amount                                   numeric(22, 6) encode zstd,
    version_id                               smallint encode az64,
    refund_entity_type                       smallint encode az64,
    refund_provided_to                       varchar(50) encode zstd,
    topup_validity_days                      integer encode az64,
    reserve_amount                           numeric(22, 6) encode az64,
    preloaded_bundle_flag                    smallint encode az64,
    staff_indicator                          smallint encode az64,
    child_addition_discount                  numeric(22, 6) encode az64,
    payg_family_indicator                    smallint encode az64,
    payg_prorate_flag                        smallint encode az64,
    payg_child_index                         smallint encode az64,
    parent_msisdn1                           varchar(50) encode zstd,
    payg_member_count                        integer encode az64,
    direct_addon_flag                        smallint encode az64,
    action_flag                              smallint encode az64,
    bundle_topup_timestamp                   varchar(50) encode zstd,
    sim_with_bundle_code                     integer encode az64,
    taxation_details                         varchar(50) encode zstd,
    reserved                                 varchar(50) encode zstd,
    bundle_purchase_date                     timestamp encode zstd,
    bundle_start_date                        timestamp encode zstd,
    renewal_payment_mode                     smallint encode az64,
    iot_bundle_flag                          smallint encode az64,
    veekbundleflag                           smallint encode az64,
    validity_overridden                      smallint encode az64,
    link_type                                smallint encode az64,
    overwrite_bundle_cost_flag               smallint encode az64,
    order_id                                 varchar(50) encode zstd,
    pocket_id                                varchar(50) encode zstd,
    da_track                                 numeric(22, 6) encode az64,
    da_principal_amount                      numeric(22, 6) encode az64,
    is_loan_request                          smallint encode az64,
    migrated_ortel_subscriber_flag           smallint encode az64,
    reward_purchased                         smallint encode az64,
    feebuffer                                varchar(50) encode zstd,
    tax_buffer                               varchar(50) encode zstd,
    paymentgateway                           varchar(50) encode zstd,
    zipcode                                  varchar(50) encode zstd,
    professional_channel_name                varchar(50) encode zstd,
    topupcriteriaflag                        smallint encode az64,
    nus_id                                   varchar(50) encode zstd,
    nus_applied                              smallint encode az64,
    slotid                                   varchar(50) encode zstd,
    reserved_bundle_cost                     varchar(50) encode zstd,
    fct_free_text_1                          varchar(50) encode zstd,
    fct_free_text_2                          varchar(50) encode zstd,
    fct_free_text_3                          varchar(50) encode zstd,
    fct_free_text_4                          varchar(50) encode zstd,
    fct_free_text_5                          varchar(50) encode zstd,
    fct_free_text_6                          varchar(50) encode zstd,
    fct_free_text_7                          varchar(50) encode zstd,
    fct_free_text_8                          varchar(50) encode zstd,
    fct_free_text_9                          varchar(50) encode zstd,
    fct_free_text_10                         varchar(50) encode zstd,
    cdr_dt                                   date encode az64,
    cdr_dt_month                             integer,
    cdr_dt_num                               integer encode az64,
    is_bundle_loyalty                        smallint encode az64,
    bundle_usage_1                           numeric(22, 6) encode az64,
    bundle_usage_2                           numeric(22, 6) encode az64,
    cdr_dt_gmt                               timestamp encode zstd,
    cdr_dt_month_gmt                         integer encode az64,
    cdr_dt_num_gmt                           integer encode az64,
    cdr_dt_hour_gmt                          integer encode az64,
    expiry_date_derived                      date encode az64,
    expiry_date_derived_num                  integer encode az64,
    expiry_date_month_derived                integer encode az64,
    roaming_partner_name                     varchar(50) encode zstd,
    filename                                 varchar(50) not null encode zstd,
    batch_id                                 integer     not null encode zstd,
    created_date                             timestamp   not null encode zstd,
    rec_checksum                             varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, network_id, operation_code);

create table fact_rrbs_topup_duplcdr
(
    sk_rrbs_topup                            bigint default default_identity(167660, 0, ('1,1'::character varying)::text) encode zstd,
    operation_code                           smallint,
    network_id                               smallint,
    recharge_type                            smallint encode az64,
    msisdn                                   bigint encode az64,
    imsi                                     bigint encode az64 distkey,
    account_pin_number                       varchar(50) encode zstd,
    voucher_card_id                          integer encode az64,
    special_topup_amount                     numeric(22, 6) encode az64,
    transaction_id                           varchar(50) encode zstd,
    new_balance                              numeric(22, 6) encode az64,
    face_value                               numeric(22, 6) encode az64,
    recharge_amount                          numeric(22, 6) encode az64,
    promo_validity_date                      date encode az64,
    free_minutes                             integer encode az64,
    free_voucher_onnet_minutes               integer encode az64,
    free_minutes_expiry_date                 date encode az64,
    free_sms                                 integer encode az64,
    free_voucher_onnet_sms                   integer encode az64,
    free_sms_expiry_date                     date encode az64,
    free_offnet_minutes                      integer encode az64,
    free_voucher_offnet_minutes              integer encode az64,
    free_offnet_minutes_expiry_date          date encode az64,
    free_offnet_sms                          integer encode az64,
    free_voucher_offnet_sms                  integer encode az64,
    free_offnet_sms_expiry_date              date encode az64,
    free_offnet2_minutes                     integer encode az64,
    free_vouchercard_offnet2_minutes         integer encode az64,
    free_offnet2_minutes_expiry_date         date encode az64,
    free_offnet2_sms                         integer encode az64,
    free_vouchercard_offnet2_sms             integer encode az64,
    free_offnet2_sms_expiry_date             date encode az64,
    free_offnet3_minutes                     integer encode az64,
    free_vouchercard_offnet3_minutes         integer encode az64,
    free_offnet3_minutes_expiry_date         date encode az64,
    free_offnet3_sms                         integer encode az64,
    free_vouchercard_offnet3_sms             integer encode az64,
    free_offnet3_sms_expiry_date             date encode az64,
    free_data                                bigint encode az64,
    free_voucher_data                        bigint encode az64,
    free_data_expirydate                     date encode az64,
    account_validity_date                    date encode az64,
    lyca_voucher_card_id                     varchar(50) encode zstd,
    planid                                   smallint encode az64,
    topup_counter                            smallint encode az64,
    bundle_code                              integer encode az64,
    imei                                     varchar(25) encode zstd,
    voucher_onnet_mins_expdt                 date encode az64,
    voucher_onnet_sms_expdt                  date encode az64,
    voucher_offnet_mins_expdt1               date encode az64,
    voucher_offnet_sms_expdt1                date encode az64,
    voucher_offnet_mins_expdt2               date encode az64,
    voucher_offnet_sms_expdt2                date encode az64,
    voucher_offnet_mins_expdt3               date encode az64,
    voucher_offnet_sms_expdt3                date encode az64,
    voucher_free_dataexp                     date encode az64,
    retailer_msisdn                          varchar(21) encode zstd,
    staff_msisdn                             varchar(21) encode zstd,
    wlm_topupmode                            varchar(50) encode zstd,
    face_value_1                             numeric(22, 6) encode az64,
    promo_validity_days                      integer encode az64,
    oldplanid                                integer encode az64,
    onnet_mt_mins                            integer encode az64,
    voucher_onnet_mt_mins                    integer encode az64,
    onnet_mt_sms                             integer encode az64,
    voucher_onnet_mt_sms                     integer encode az64,
    onnet_mt_exp_dt                          date encode az64,
    voucher_onnet_mt_expiry_date             date encode az64,
    offnet_mt_mins                           integer encode az64,
    voucher_offnet_mt_mins                   integer encode az64,
    offnet_mt_sms                            integer encode az64,
    voucher_offnet_mt_sms                    integer encode az64,
    offnet_mt_exp_dt                         date encode az64,
    voucher_offnet_mt_expiry_date            date encode az64,
    bundle_name                              varchar(100) encode zstd,
    old_account_balance                      numeric(22, 6) encode az64,
    parent_msisdn                            varchar(25) encode zstd,
    rrbs_transaction_id                      varchar(50) encode zstd,
    override_bundle                          integer encode az64,
    vouchernetworkid                         smallint encode az64,
    accid                                    varchar(10) encode zstd,
    deptid                                   varchar(10) encode zstd,
    bundle_catery                            smallint encode az64,
    plan_validity_days                       smallint encode az64,
    account_id                               bigint encode az64,
    sim_number                               bigint encode az64,
    cdr_time_stamp                           timestamp encode zstd,
    reservation                              smallint encode az64,
    discount_promo_code                      varchar(50) encode zstd,
    discount_promo_amount                    numeric(22, 6) encode az64,
    primary_bundle_code                      integer encode az64,
    family_account_id                        varchar(50) encode zstd,
    tax                                      numeric(22, 6) encode az64,
    number_of_installments                   integer encode az64,
    oba_bundle_flag                          smallint encode az64,
    oba_due_amount                           numeric(22, 6) encode az64,
    parent_bundle_code                       integer encode az64,
    bundle_unit_type                         smallint encode az64,
    contract_start_date                      date encode az64,
    contract_end_date                        varchar(50) encode zstd,
    flh_flag                                 smallint encode az64,
    exibs_retailer_transaction_id            varchar(50) encode zstd,
    operation_flag                           smallint encode az64,
    vat_amount                               numeric(22, 6) encode az64,
    special_discount_code                    varchar(50) encode zstd,
    special_discount_amount                  numeric(22, 6) encode az64,
    number_of_installments_discounts_applied varchar(50) encode zstd,
    actual_bundle_cost                       numeric(22, 6) encode az64,
    reservation_reference_transaction_id     varchar(50) encode zstd,
    bundle_expiry_type                       smallint encode az64,
    bundle_balance                           numeric(22, 6) encode az64,
    muv_indicator                            smallint encode az64,
    bundle_group_type                        smallint encode az64,
    sequence_number                          smallint encode az64,
    amount_refunded                          numeric(22, 6) encode az64,
    forcible_cancellation                    varchar(50) encode zstd,
    payment_mode_indicator                   varchar(50) encode zstd,
    amount                                   numeric(22, 6) encode zstd,
    version_id                               smallint encode az64,
    refund_entity_type                       smallint encode az64,
    refund_provided_to                       varchar(50) encode zstd,
    topup_validity_days                      integer encode az64,
    reserve_amount                           numeric(22, 6) encode az64,
    preloaded_bundle_flag                    smallint encode az64,
    staff_indicator                          smallint encode az64,
    child_addition_discount                  numeric(22, 6) encode az64,
    payg_family_indicator                    smallint encode az64,
    payg_prorate_flag                        smallint encode az64,
    payg_child_index                         smallint encode az64,
    parent_msisdn1                           varchar(50) encode zstd,
    payg_member_count                        integer encode az64,
    direct_addon_flag                        smallint encode az64,
    action_flag                              smallint encode az64,
    bundle_topup_timestamp                   varchar(50) encode zstd,
    sim_with_bundle_code                     integer encode az64,
    taxation_details                         varchar(50) encode zstd,
    reserved                                 varchar(50) encode zstd,
    bundle_purchase_date                     timestamp encode zstd,
    bundle_start_date                        timestamp encode zstd,
    renewal_payment_mode                     smallint encode az64,
    iot_bundle_flag                          smallint encode az64,
    veekbundleflag                           smallint encode az64,
    validity_overridden                      smallint encode az64,
    link_type                                smallint encode az64,
    overwrite_bundle_cost_flag               smallint encode az64,
    order_id                                 varchar(50) encode zstd,
    pocket_id                                varchar(50) encode zstd,
    da_track                                 numeric(22, 6) encode az64,
    da_principal_amount                      numeric(22, 6) encode az64,
    is_loan_request                          smallint encode az64,
    migrated_ortel_subscriber_flag           smallint encode az64,
    reward_purchased                         smallint encode az64,
    feebuffer                                varchar(50) encode zstd,
    tax_buffer                               varchar(50) encode zstd,
    paymentgateway                           varchar(50) encode zstd,
    zipcode                                  varchar(50) encode zstd,
    professional_channel_name                varchar(50) encode zstd,
    topupcriteriaflag                        smallint encode az64,
    nus_id                                   varchar(50) encode zstd,
    nus_applied                              smallint encode az64,
    slotid                                   varchar(50) encode zstd,
    reserved_bundle_cost                     varchar(50) encode zstd,
    fct_free_text_1                          varchar(50) encode zstd,
    fct_free_text_2                          varchar(50) encode zstd,
    fct_free_text_3                          varchar(50) encode zstd,
    fct_free_text_4                          varchar(50) encode zstd,
    fct_free_text_5                          varchar(50) encode zstd,
    fct_free_text_6                          varchar(50) encode zstd,
    fct_free_text_7                          varchar(50) encode zstd,
    fct_free_text_8                          varchar(50) encode zstd,
    fct_free_text_9                          varchar(50) encode zstd,
    fct_free_text_10                         varchar(50) encode zstd,
    cdr_dt                                   date encode az64,
    cdr_dt_month                             integer,
    cdr_dt_num                               integer encode az64,
    is_bundle_loyalty                        smallint encode az64,
    bundle_usage_1                           numeric(22, 6) encode az64,
    bundle_usage_2                           numeric(22, 6) encode az64,
    cdr_dt_gmt                               timestamp encode zstd,
    cdr_dt_month_gmt                         integer encode az64,
    cdr_dt_num_gmt                           integer encode az64,
    cdr_dt_hour_gmt                          integer encode az64,
    expiry_date_derived                      date encode az64,
    expiry_date_derived_num                  integer encode az64,
    expiry_date_month_derived                integer encode az64,
    roaming_partner_name                     varchar(50) encode zstd,
    filename                                 varchar(50) not null encode zstd,
    batch_id                                 integer     not null encode zstd,
    created_date                             timestamp   not null encode zstd,
    rec_checksum                             varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, network_id, operation_code);

create table fact_rrbs_topup_latecdr
(
    sk_rrbs_topup                            bigint default default_identity(167663, 0, ('1,1'::character varying)::text) encode zstd,
    operation_code                           smallint,
    network_id                               smallint,
    recharge_type                            smallint encode az64,
    msisdn                                   bigint encode az64,
    imsi                                     bigint encode az64 distkey,
    account_pin_number                       varchar(50) encode zstd,
    voucher_card_id                          integer encode az64,
    special_topup_amount                     numeric(22, 6) encode az64,
    transaction_id                           varchar(50) encode zstd,
    new_balance                              numeric(22, 6) encode az64,
    face_value                               numeric(22, 6) encode az64,
    recharge_amount                          numeric(22, 6) encode az64,
    promo_validity_date                      date encode az64,
    free_minutes                             integer encode az64,
    free_voucher_onnet_minutes               integer encode az64,
    free_minutes_expiry_date                 date encode az64,
    free_sms                                 integer encode az64,
    free_voucher_onnet_sms                   integer encode az64,
    free_sms_expiry_date                     date encode az64,
    free_offnet_minutes                      integer encode az64,
    free_voucher_offnet_minutes              integer encode az64,
    free_offnet_minutes_expiry_date          date encode az64,
    free_offnet_sms                          integer encode az64,
    free_voucher_offnet_sms                  integer encode az64,
    free_offnet_sms_expiry_date              date encode az64,
    free_offnet2_minutes                     integer encode az64,
    free_vouchercard_offnet2_minutes         integer encode az64,
    free_offnet2_minutes_expiry_date         date encode az64,
    free_offnet2_sms                         integer encode az64,
    free_vouchercard_offnet2_sms             integer encode az64,
    free_offnet2_sms_expiry_date             date encode az64,
    free_offnet3_minutes                     integer encode az64,
    free_vouchercard_offnet3_minutes         integer encode az64,
    free_offnet3_minutes_expiry_date         date encode az64,
    free_offnet3_sms                         integer encode az64,
    free_vouchercard_offnet3_sms             integer encode az64,
    free_offnet3_sms_expiry_date             date encode az64,
    free_data                                bigint encode az64,
    free_voucher_data                        bigint encode az64,
    free_data_expirydate                     date encode az64,
    account_validity_date                    date encode az64,
    lyca_voucher_card_id                     varchar(50) encode zstd,
    planid                                   smallint encode az64,
    topup_counter                            smallint encode az64,
    bundle_code                              integer encode az64,
    imei                                     varchar(25) encode zstd,
    voucher_onnet_mins_expdt                 date encode az64,
    voucher_onnet_sms_expdt                  date encode az64,
    voucher_offnet_mins_expdt1               date encode az64,
    voucher_offnet_sms_expdt1                date encode az64,
    voucher_offnet_mins_expdt2               date encode az64,
    voucher_offnet_sms_expdt2                date encode az64,
    voucher_offnet_mins_expdt3               date encode az64,
    voucher_offnet_sms_expdt3                date encode az64,
    voucher_free_dataexp                     date encode az64,
    retailer_msisdn                          varchar(21) encode zstd,
    staff_msisdn                             varchar(21) encode zstd,
    wlm_topupmode                            varchar(50) encode zstd,
    face_value_1                             numeric(22, 6) encode az64,
    promo_validity_days                      integer encode az64,
    oldplanid                                integer encode az64,
    onnet_mt_mins                            integer encode az64,
    voucher_onnet_mt_mins                    integer encode az64,
    onnet_mt_sms                             integer encode az64,
    voucher_onnet_mt_sms                     integer encode az64,
    onnet_mt_exp_dt                          date encode az64,
    voucher_onnet_mt_expiry_date             date encode az64,
    offnet_mt_mins                           integer encode az64,
    voucher_offnet_mt_mins                   integer encode az64,
    offnet_mt_sms                            integer encode az64,
    voucher_offnet_mt_sms                    integer encode az64,
    offnet_mt_exp_dt                         date encode az64,
    voucher_offnet_mt_expiry_date            date encode az64,
    bundle_name                              varchar(100) encode zstd,
    old_account_balance                      numeric(22, 6) encode az64,
    parent_msisdn                            varchar(25) encode zstd,
    rrbs_transaction_id                      varchar(50) encode zstd,
    override_bundle                          integer encode az64,
    vouchernetworkid                         smallint encode az64,
    accid                                    varchar(10) encode zstd,
    deptid                                   varchar(10) encode zstd,
    bundle_catery                            smallint encode az64,
    plan_validity_days                       smallint encode az64,
    account_id                               bigint encode az64,
    sim_number                               bigint encode az64,
    cdr_time_stamp                           timestamp encode zstd,
    reservation                              smallint encode az64,
    discount_promo_code                      varchar(50) encode zstd,
    discount_promo_amount                    numeric(22, 6) encode az64,
    primary_bundle_code                      integer encode az64,
    family_account_id                        varchar(50) encode zstd,
    tax                                      numeric(22, 6) encode az64,
    number_of_installments                   integer encode az64,
    oba_bundle_flag                          smallint encode az64,
    oba_due_amount                           numeric(22, 6) encode az64,
    parent_bundle_code                       integer encode az64,
    bundle_unit_type                         smallint encode az64,
    contract_start_date                      date encode az64,
    contract_end_date                        varchar(50) encode zstd,
    flh_flag                                 smallint encode az64,
    exibs_retailer_transaction_id            varchar(50) encode zstd,
    operation_flag                           smallint encode az64,
    vat_amount                               numeric(22, 6) encode az64,
    special_discount_code                    varchar(50) encode zstd,
    special_discount_amount                  numeric(22, 6) encode az64,
    number_of_installments_discounts_applied varchar(50) encode zstd,
    actual_bundle_cost                       numeric(22, 6) encode az64,
    reservation_reference_transaction_id     varchar(50) encode zstd,
    bundle_expiry_type                       smallint encode az64,
    bundle_balance                           numeric(22, 6) encode az64,
    muv_indicator                            smallint encode az64,
    bundle_group_type                        smallint encode az64,
    sequence_number                          smallint encode az64,
    amount_refunded                          numeric(22, 6) encode az64,
    forcible_cancellation                    varchar(50) encode zstd,
    payment_mode_indicator                   varchar(50) encode zstd,
    amount                                   numeric(22, 6) encode zstd,
    version_id                               smallint encode az64,
    refund_entity_type                       smallint encode az64,
    refund_provided_to                       varchar(50) encode zstd,
    topup_validity_days                      integer encode az64,
    reserve_amount                           numeric(22, 6) encode az64,
    preloaded_bundle_flag                    smallint encode az64,
    staff_indicator                          smallint encode az64,
    child_addition_discount                  numeric(22, 6) encode az64,
    payg_family_indicator                    smallint encode az64,
    payg_prorate_flag                        smallint encode az64,
    payg_child_index                         smallint encode az64,
    parent_msisdn1                           varchar(50) encode zstd,
    payg_member_count                        integer encode az64,
    direct_addon_flag                        smallint encode az64,
    action_flag                              smallint encode az64,
    bundle_topup_timestamp                   varchar(50) encode zstd,
    sim_with_bundle_code                     integer encode az64,
    taxation_details                         varchar(50) encode zstd,
    reserved                                 varchar(50) encode zstd,
    bundle_purchase_date                     timestamp encode zstd,
    bundle_start_date                        timestamp encode zstd,
    renewal_payment_mode                     smallint encode az64,
    iot_bundle_flag                          smallint encode az64,
    veekbundleflag                           smallint encode az64,
    validity_overridden                      smallint encode az64,
    link_type                                smallint encode az64,
    overwrite_bundle_cost_flag               smallint encode az64,
    order_id                                 varchar(50) encode zstd,
    pocket_id                                varchar(50) encode zstd,
    da_track                                 numeric(22, 6) encode az64,
    da_principal_amount                      numeric(22, 6) encode az64,
    is_loan_request                          smallint encode az64,
    migrated_ortel_subscriber_flag           smallint encode az64,
    reward_purchased                         smallint encode az64,
    feebuffer                                varchar(50) encode zstd,
    tax_buffer                               varchar(50) encode zstd,
    paymentgateway                           varchar(50) encode zstd,
    zipcode                                  varchar(50) encode zstd,
    professional_channel_name                varchar(50) encode zstd,
    topupcriteriaflag                        smallint encode az64,
    nus_id                                   varchar(50) encode zstd,
    nus_applied                              smallint encode az64,
    slotid                                   varchar(50) encode zstd,
    reserved_bundle_cost                     varchar(50) encode zstd,
    fct_free_text_1                          varchar(50) encode zstd,
    fct_free_text_2                          varchar(50) encode zstd,
    fct_free_text_3                          varchar(50) encode zstd,
    fct_free_text_4                          varchar(50) encode zstd,
    fct_free_text_5                          varchar(50) encode zstd,
    fct_free_text_6                          varchar(50) encode zstd,
    fct_free_text_7                          varchar(50) encode zstd,
    fct_free_text_8                          varchar(50) encode zstd,
    fct_free_text_9                          varchar(50) encode zstd,
    fct_free_text_10                         varchar(50) encode zstd,
    cdr_dt                                   date encode az64,
    cdr_dt_month                             integer,
    cdr_dt_num                               integer encode az64,
    is_bundle_loyalty                        smallint encode az64,
    bundle_usage_1                           numeric(22, 6) encode az64,
    bundle_usage_2                           numeric(22, 6) encode az64,
    cdr_dt_gmt                               timestamp encode zstd,
    cdr_dt_month_gmt                         integer encode az64,
    cdr_dt_num_gmt                           integer encode az64,
    cdr_dt_hour_gmt                          integer encode az64,
    expiry_date_derived                      date encode az64,
    expiry_date_derived_num                  integer encode az64,
    expiry_date_month_derived                integer encode az64,
    roaming_partner_name                     varchar(50) encode zstd,
    filename                                 varchar(50) not null encode zstd,
    batch_id                                 integer     not null encode zstd,
    created_date                             timestamp   not null encode zstd,
    rec_checksum                             varchar(32) encode zstd
)
    diststyle key
    sortkey (cdr_dt_month, cdr_dt_num, network_id, operation_code);
