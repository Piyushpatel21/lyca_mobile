
CREATE TABLE IF NOT EXISTS uk_rrbs_dm.fact_rrbs_gprs
(
sk_rrbs_gprs BIGINT  GENERATED BY DEFAULT AS identity(1,1) ENCODE zstd	 ,
cdr_type	smallint encode zstd ,
network_id	smallint encode zstd ,
data_feature	smallint encode zstd ,
tariffplan_id	smallint encode zstd ,
service_id	smallint encode zstd ,
msisdn	bigint encode zstd ,
apn	VARCHAR(100) encode zstd ,
pdp_address	VARCHAR(50) encode zstd ,
cellid	VARCHAR(50) encode zstd ,
imei	VARCHAR(50) encode zstd ,
imsi	bigint encode zstd ,
serving_node	VARCHAR(30) encode zstd ,
ggsn_address	VARCHAR(50) encode zstd ,
roaming_zone_name	VARCHAR(30) encode zstd ,
roam_flag	smallint encode zstd ,
granted_bytes_cumulative	bigint encode zstd ,
granted_money	decimal(20,6) encode zstd ,
total_used_bytes	BIGINT encode zstd ,
chargeable_used_bytes	BIGINT encode zstd ,
uploaded_bytes	BIGINT encode zstd ,
downloaded_bytes	BIGINT encode zstd ,
data_connection_time	timestamp encode zstd ,
data_connection_dt	date encode raw , -- derived from data_connection_time
data_termination_time	timestamp encode zstd ,
time_duration	Int encode zstd ,
initial_account_balance	decimal(20,6) encode zstd ,
data_charge	decimal(20,6) encode zstd ,
final_account_balance	decimal(20,6) encode zstd ,
free_bytes	bigint encode zstd ,
sessionid	VARCHAR(50) encode zstd ,
last_topup_type	smallint encode zstd ,
free_data_expiry_date	date encode zstd ,
charge_indicator	smallint encode zstd ,
final_unit_indicator	smallint encode zstd ,
bundle_code	VARCHAR(10) encode raw ,
accid	VARCHAR(11) encode zstd ,
deptid	VARCHAR(15) encode zstd ,
bundle_used_data	VARCHAR(10) encode zstd ,
bundle_data_charge	decimal(20,6) encode zstd ,
bundle_balance	decimal(20,6) encode zstd ,
bundle_plan_id	VARCHAR(5) encode zstd ,
local_roam_country_code	smallint encode zstd ,
sdfid	smallint encode zstd ,
rategroupid	smallint encode zstd ,
serviceid	VARCHAR(4) encode zstd ,
cdr_time_stamp	timestamp encode zstd ,
intial_free_units	bigint encode zstd ,
subscriber_type	smallint encode zstd ,
cdr_sequence_number	Int encode zstd ,
sub_acct_id	bigint encode zstd ,
ggsn_time	CHARACTER VARYING(100) encode zstd ,
tariff_plan_change_id	smallint encode zstd ,
used_units_before_tariff_plan_change	bigint encode zstd ,
family_account_id	int encode zstd ,
bundle_version_name	VARCHAR(50) encode zstd ,
bundle_versionid	smallint encode zstd ,
reward_slab_id	smallint encode zstd ,
pricing_plan_id	smallint encode zstd ,
rate_id	int encode zstd ,
pocket_id	int encode zstd ,
consumed_promo_amount	decimal(20,6) encode zstd ,
consumed_surcharge	decimal(20,6) encode zstd ,
rlh_charging_indicator	smallint encode zstd ,
granted_bytes_current	bigint encode zstd ,
roaming_partner_id	smallint encode zstd ,
filename	varchar(100) encode zstd ,	 
batch_id INTEGER NOT NULL	 encode zstd ,
created_date TIMESTAMP WITHOUT TIME ZONE NOT NULL  	 encode zstd 
)
DISTSTYLE KEY
 DISTKEY (imsi)
SORTKEY (
	data_connection_dt,	
	Bundle_Code
	) 
	;
 